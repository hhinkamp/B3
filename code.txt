First draft of the code.
